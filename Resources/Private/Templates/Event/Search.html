{namespace e=Undkonsorten\Eventmgmt\ViewHelpers}

<f:layout name="Default" />
<f:section name="main">
	<f:render partial="Search/Form" arguments="{regions:regions, topics:topics, demand:demand}" />
	<p class="listArchiveSwitch">
		<span><f:translate key="upcomingEvents" /></span>
		<f:link.action action="archive" pageUid="{settings.pidArchive}"><f:translate key="archivLink" /></f:link.action>
	</p>
	<div class="list event eventSearch">
			<f:if condition="{demanded}">
				<f:then>
					<p class="countResults">
						<f:translate key="search.open" />
						<f:if condition="{demand.type}">
							<f:translate key="search.type" arguments="{0:'{f:translate(key:\"type.{demand.type}\")}'}" />
						</f:if>
						<f:if condition="{demand.subject}">
							<f:translate key="search.sword" arguments="{0:demand.subject}" />
						</f:if>
						<f:if condition="{demanded -> f:count()} < 2">
							<f:then><f:translate key="search.results.one" arguments="{0:'{f:count(subject:demanded)}'}" /></f:then>
							<f:else><f:translate key="search.results.many" arguments="{0:'{f:count(subject:demanded)}'}" /></f:else>
						</f:if>
					</p>
					<f:if condition="{f:count(subject:events)} <=  {settings.itemsPerPage}">
						<f:then>
							<ul class="module-list-items">
							<f:for each="{demanded}" as="event">
								<f:render partial="List/Event" arguments="{event:event}" />
							</f:for>
							</ul>
						</f:then>
						<f:else>
							<e:widget.paginate objects="{demanded}" as="paginatedEvents" pagination="pagination" configuration="{itemsPerPage: settings.itemsPerPage, insertAbove: settings.paginate.insertAbove, insertBelow: settings.paginate.insertBelow, maximumNumberOfLinks: 5}" additionalParamsPrefix="tx_eventmgmt_list" additionalParams="{demand:demand.parameter}">
								<ul class="module-list-items">
								<f:for each="{paginatedEvents}" as="event">
									<f:render partial="List/Event" arguments="{event:event}" />
								</f:for>
								</ul>
							</e:widget.paginate>
						</f:else>
					</f:if>
					<f:if condition="{settings.showPaginator}">
						<f:else>
							<f:if condition="{settings.itemsPerPage} < {allEvents}">
								<div class="show-all">
									<f:link.page class="show-all-link" pageUid="{settings.pidList}"><f:translate key="showAll" /></f:link.page>
								</div>
							</f:if>
						</f:else>
					</f:if>
					
				</f:then>
				<f:else>
					<div class="no-event-found">
						<f:translate key="search.results.none" />
					</div>
				</f:else>
			</f:if>
	</div>
</f:section>
